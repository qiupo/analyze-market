#!/bin/bash

echo "ğŸš€ BandMaster Pro - æ™ºç­–æ³¢æ®µäº¤æ˜“åŠ©æ‰‹"
echo "=================================="
echo

# æ£€æŸ¥Pythonæ˜¯å¦å®‰è£…
if ! command -v python3 &> /dev/null; then
    echo "âŒ é”™è¯¯: æœªæ‰¾åˆ° Python3"
    echo "è¯·å…ˆå®‰è£… Python 3.8 æˆ–æ›´é«˜ç‰ˆæœ¬"
    exit 1
fi

# æ£€æŸ¥æ˜¯å¦åœ¨é¡¹ç›®ç›®å½•ä¸­
if [ ! -f "src/app.py" ]; then
    echo "âŒ é”™è¯¯: æœªæ‰¾åˆ° src/app.py æ–‡ä»¶"
    echo "è¯·ç¡®ä¿åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸­è¿è¡Œæ­¤è„šæœ¬"
    exit 1
fi

echo "âœ… ç¯å¢ƒæ£€æŸ¥é€šè¿‡"
echo

# æ£€æŸ¥è™šæ‹Ÿç¯å¢ƒ
if [ -d "venv" ]; then
    echo "ğŸ”§ æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ..."
    source venv/bin/activate
fi

# æ£€æŸ¥ä¾èµ–æ˜¯å¦å®‰è£…
if ! python3 -c "import streamlit" 2>/dev/null; then
    echo "ğŸ“¦ å®‰è£…ä¾èµ–..."
    pip install -r requirements.txt
fi

echo "ğŸš€ å¯åŠ¨åº”ç”¨..."
python3 run.py 